<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Выбор слота — Walk & Talk MVP</title>
  <style>
    :root { --bg:#0b0b0f; --card:#121219; --text:#e8e8f0; --muted:#9aa0a6; --accent:#6ee7b7; }
    * { box-sizing:border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; background:var(--bg); color:var(--text); }
    .wrap { max-width:720px; margin:0 auto; padding:32px 20px 56px; }
    .card { background:var(--card); border:1px solid #1f2130; border-radius:16px; padding:24px; box-shadow:0 2px 20px rgba(0,0,0,.25); }
    h1 { margin:0 0 8px; font-size:28px; letter-spacing:.2px; }
    p.lead { margin:0 0 16px; color:var(--muted); }
    .grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(180px,1fr)); gap:12px; margin:20px 0 12px; }
    button.slot { padding:14px 16px; border-radius:12px; border:1px solid #2a2d41; background:#171826; color:#fff; font-weight:600; cursor:pointer; transition:transform .04s ease, border-color .2s ease; }
    button.slot:hover { border-color:#3b3f5e; transform:translateY(-1px); }
    button.slot:disabled { opacity:.6; cursor:default; }
    .ok { display:none; margin-top:10px; color:var(--accent); font-weight:600; }
    .footer { margin-top:28px; display:flex; gap:8px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .tiny { font-size:12px; color:#9196a7; }
    a.link { color:#9ad7ff; text-decoration:none; border-bottom:1px dotted #2b5; }
    @media (prefers-color-scheme: light) {
      :root { --bg:#fafafa; --card:#ffffff; --text:#0d0f14; --muted:#586174; --accent:#0a7f5a; }
      .card { border-color:#e6e8ef; box-shadow:0 2px 20px rgba(0,0,0,.06); }
      button.slot { background:#f3f4f8; color:#0d0f14; border-color:#d9dbe6; }
      button.slot:hover { border-color:#c6c9d8; }
    }
  </style>
  <noscript><style>.grid{display:none} .ok{display:block;color:#f66;font-weight:700}</style></noscript>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Выбери удобное время</h1>
      <p class="lead">Тестируем идею. Нажми на слот — этого достаточно, чтобы мы поняли интерес. Никаких персональных данных.</p>

      <div class="grid" id="slots"></div>
      <div id="ok" class="ok">Спасибо! Интерес зафиксирован.</div>

      <div class="footer">
        <div class="tiny">MVP • GitHub Pages</div>
        <div class="tiny"><a class="link" href="thanks.html">Страница «спасибо»</a></div>
      </div>
    </div>
  </div>

<script>
  /* === НАСТРОЙКА ===
     Поменяй список слотов при необходимости.
     Вариант A/B берётся из ?variant=... (например, price / value).
  */
  const SLOTS = ["19:00","20:00","21:00"];
  const VARIANT = new URLSearchParams(location.search).get('variant') || 'default';

  /* === ТВОЯ Google Form (Slot + Variant) ===
     ВАЖНО: именно /formResponse (не /viewform)
  */
  const FORM_BASE     = "https://docs.google.com/forms/d/e/1FAIpQLSfHdEkyLyyvjmbTR4MgJ-iYDH56hTf5So9J5AjO5KWq_k5gDQ/formResponse";
  const ENTRY_SLOT    = "entry.516892861";   // Slot
  const ENTRY_VARIANT = "entry.1461502828";  // Variant

  function logToGoogleForms(slotLabel) {
    // Собираем URL вида .../formResponse?entry.X=...&entry.Y=...&submit=Submit
    const p = new URLSearchParams();
    p.set(ENTRY_SLOT,   slotLabel);
    p.set(ENTRY_VARIANT, VARIANT);
    p.set('submit', 'Submit');
    const url = FORM_BASE + "?" + p.toString() + "&t=" + Date.now();

    // «Пиксель»: держим его в DOM, чтобы запрос не оборвался при редиректе
    const img = new Image();
    img.width = 1; img.height = 1; img.alt = "";
    img.style = "position:absolute;left:-9999px;top:-9999px;";
    img.src = url;
    document.body.appendChild(img);
  }

  function makeSlotButton(label){
    const btn = document.createElement('button');
    btn.className = 'slot';
    btn.textContent = label;
    btn.addEventListener('click', () => onSlotClick(label, btn));
    return btn;
  }

  let clicked = false;
  function onSlotClick(label, btn){
    if (clicked) return;            // защита от двойных кликов
    clicked = true;

    // 1) логируем
    logToGoogleForms(label);

    // 2) мгновенная обратная связь и дизейбл остальных
    const ok = document.getElementById('ok');
    ok.style.display = 'block';
    ok.textContent = `Спасибо! Слот ${label} отмечен.`;
    document.querySelectorAll('button.slot').forEach(b => b.disabled = true);

    // 3) редирект на «спасибо» (даём 300 мс, чтобы пиксель ушёл)
    setTimeout(() => {
      location.href = `thanks.html?slot=${encodeURIComponent(label)}&variant=${encodeURIComponent(VARIANT)}`;
    }, 300);
  }

  function mount(){
    const root = document.getElementById('slots');
    SLOTS.forEach(s => root.appendChild(makeSlotButton(s)));

    // опционально: title из ?title=
    const title = new URLSearchParams(location.search).get('title');
    if (title) document.querySelector('h1').textContent = title;
  }
  mount();
</script>
</body>
</html>
